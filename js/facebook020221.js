var pageloadforfacebook;function facebookUnilogin(e){pageloadforfacebook=e,connectFacebookEnquiry(),FB.login(function(e){e.session},{scope:"email,publish_stream"})}function connectFacebookEnquiry(){FB.init({appId:$1("apiId").value,status:!0,cookie:!0,xfbml:!0,version:"v2.4"}),FB.Event.subscribe("auth.login",function(e){login()}),FB.getLoginStatus(function(e){"connected"===e.status?(fbResponse=e.status,login(fbResponse),e.authResponse.userID,e.authResponse.accessToken):"not_authorized"===e.status?(fbResponse=e.status,FB.Event.subscribe("auth.login",function(e){login(fbResponse)})):fbResponse=e.status})}function login(){FB.api("/me","GET",{fields:"id,email,first_name,last_name"},function(e){fqlQuery()}),null!=document.getElementById("enq_fb")&&(document.getElementById("enq_fb").style.display="none")}function graphStreamPublish(){description=$1("description").value,hrefLink=$1("hrefLink").value,hrefTitle=$1("hrefTitle").value,FB.api({method:"stream.publish",message:$1("message").value,attachment:{name:$1("name").value,caption:$1("caption").value,description:description,href:hrefLink,media:[{type:"image",src:$1("fbkimg").value,href:$1("mediahref").value}]},action_links:[{text:hrefTitle,href:hrefLink}]},function(e){})}function fqlQuery(){FB.api("/me","GET",{fields:"id,email,first_name,last_name"},function(e){var a=e.first_name,r=e.last_name,l=e.email,n=e.id,o=getIdValue("postId"),i=getIdValue("trckActId"),e=getIdValue("actIdCnst"+i);"find_articles"==getIdValue("pageSrc")&&isValidObject("crntPostId")&&(o=getIdValue("crntPostId")),null!=l&&"undefined"!=l&&facebookRegister(a,r,l,"",null,null,n,pageloadforfacebook,o,i,e)})}function facebookRegister(a,e,r,l,n,o,i,t,s,u,g){var d=new sack;d.requestFile="/study/RegisterViaFacebook.html?fname="+a+"&lname="+e+"&email="+r+"&hometown="+n+"&country="+o+"&fbId="+i+"&fbpagename="+t+"&postId="+s+"&trckActId="+u+"&gaParam="+g+"&screenSize="+screenWidth(),d.onCompletion=function(){var e;"lightboxlogin"==t&&(e=d.response,isBlankOrNull(e)||null!=(e=e.split("#SP#"))&&0<e.length&&"false"==e[0]&&ga("send","event","Registration page","Register with facebook","",1)),getUserFBAutoLogin(d,a,s,u,g)},d.runAJAX()}function getUserFBAutoLogin(e,a,r,l,n){var o=e.response,i="";if(isBlankOrNull(o)||-1==o.indexOf("##")||null!=(g=o.split("##"))&&4==g.length&&(i=g[3]),null!=i){var t,s,u=i.split("azw-wza"),g=u[2];if("header"==pageloadforfacebook){g||graphStreamPublish();i="<span>";"true"==$1("countryflag").value&&(i+='<a href="#" onclick="countrydropdown("cntr");" class="abdr undr"><span class="dar"><span class="'+$1("countryDomain").value+'">'+$1("hmddtext").value+"</span></span></a>"),"null"!=$("htmlContentFromCms").value&&(i+=$("htmlContentFromCms").value),i+='<em class="usr"> <strong>'+$1("hitext").value+", "+u[4]+"</strong>  -</em>",i+='<a class="abdr"  href="/study/user/profile.html">'+$1("mydetail").value+"</a>",i+='<a href="/study/logout.html" >'+$1("logoutId").value+"</a>","true"==$1("countryflag").value&&(i+='<div class="cntr" id="cntr" style="display:none"></div>'),i+=" </span>",$1("login").innerHTML=i}else if("enquiry"==pageloadforfacebook||"nonmasenquiry"==pageloadforfacebook){if(g||graphStreamPublish(),"nonmasenquiry"==pageloadforfacebook)if(null!=u[6]&&"null"!=u[6])$("#fstname").val(u[4]),$("#fstnameId").val(u[4]),$("#lstname").val(u[5]),$("#lastnameId").val(u[5]),$("#eMail").val(u[0]),$("#checkemailid").val(u[0]),$("#confirmEmailID").val(u[0]),$("#confirmEmailId").val(u[0]),$("#eMail").attr("readonly",!0),$("#confirmEmailID").attr("readonly",!0),$("#confirmEmailId").attr("readonly",!0),null!=(s=window.location.href)&&-1!=s.indexOf("&valdn=Y")?(s=s.substring(0,s.indexOf("&valdn=Y")),$1("onlyEnq")&&draftsubmit(!1),window.location.href=s):null!=$1("eBookLandingURL")&&""!=$1("eBookLandingURL").value?window.location.href=$1("eBookLandingURL").value:($1("onlyEnq")&&draftsubmit(!1),document.location.reload(!0)),""!=u[1]&&null!=u[1]&&($1("yournationality").value=u[1]);else{"undefined"!=typeof callregistrationEnDp&&callregistrationEnDp("newuser"),$("#fstname").trigger("focus").val(u[4]).trigger("blur"),$("#lstname").trigger("focus").val(u[5]).trigger("blur"),$("#fstnameId").trigger("focus").val(u[4]).trigger("blur"),$("#lastnameId").trigger("focus").val(u[5]).trigger("blur"),$("#confirmEmailId").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#confirmEmailID").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#checkemailid").val(u[0]),$("#genderid").val(""),$("#facebookid").val(u[8]),$1("onlyEnq")&&draftsubmit(!0);var d=["fnamealert","splcharfirstnameerror","serverfnameerror","lnamealert","splcharlastnameerror","serverlnameerror","confirmemailalertalert","validconfirmemailalertalert","useralreadyexist","serveremailiderror","enquirydpfacebook"];""!=u[1]&&null!=u[1]&&"null"!=u[1]&&($("#yournationality").val(u[1]).trigger("blur").focus(),d.push("nationalityalert"),d.push("servernationalityalert"));var f=0,c=d.length;for(f=0;f<c;f++)$("#"+d[f]).hide()}else $("#fstname").val(u[4]),$("#lstname").val(u[5]),$("#fstnameId").val(u[4]),$("#lastnameId").val(u[5]),document.location.reload(!0);$1("facebookloginbutton").style.display="none",$1("facebookLoginBtn").style.display="none",null!=$1("facebookloginOR")&&($1("facebookloginOR").style.display="none"),null!=$1("reg")&&($1("reg").innerHTML=""),adjustEmbedEnquiryForm()}else if("enquirylogin"==pageloadforfacebook){var m=e.response.split("##");null!=m[0]&&"AAA"==m[0]&&null!=m[1]&&(window.location.href=m[1])}else if("lightboxlogin"==pageloadforfacebook)g||graphStreamPublish(),isBlankOrNull(r)?isBlankOrNull(l)?null!=$1("previousurlforredirection")&&null!=$1("previousurlforredirection").value?-1!=$1("previousurlforredirection").value.indexOf("/registration")?window.location.href=$1("servernamefacebook").value:window.location.href=$1("previousurlforredirection").value:document.location.reload(!0):(ga("send","event","Recent searches","Saved searches",n,1,{dimension1:"Search Results",nonInteraction:1}),document.location.reload(!0)):readingListGALog(o,pageloadforfacebook);else if("lightboxregister"==pageloadforfacebook)if(null!=u[6]&&"null"!=u[6]){var p="http://"+$1("servernamefacebook").value,m=!1;g||graphStreamPublish(),isBlankOrNull(r)?isValidValue("shortListSrc")?(p+="/study/user/shortlist/profile.html",m=!0):!isValidValue("shortListType")||"C"!=$.trim(getIdValue("shortListType"))&&"O"!=$.trim(getIdValue("shortListType"))?m=(isBlankOrNull(l)?p+="/study/user/profile.html":isBlankOrNull(getIdValue("refererUrl"))||(p=appendQueryOrAmp($("#refererUrl").val(),"gaParam="+n)),!0):viewComparisonPagination($1("shortListType").value,"1","0"):readingListGALog(o,pageloadforfacebook),m&&(window.location.href=p)}else{$("#fstname").trigger("focus").val(u[4]).trigger("blur"),$("#lstname").trigger("focus").val(u[5]).trigger("blur"),$("#fstnameId").trigger("focus").val(u[4]).trigger("blur"),$("#lastnameId").trigger("focus").val(u[5]).trigger("blur"),$("#confirmEmailId").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#confirmEmailID").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#checkemailid").val(u[0]),$("#genderid").val(""),$("#facebookid").val(u[8]),$("#prepopulateFbFlag").val("Y");p=$("#passwordValue_label").html();$("#passwordValue_label").html(p.replace("*",""));d=["fstNameErrorTag","lnameErrorTag","emailErrMsgTag","confirmEmailSucErrMsg","enquirydpfacebook","facebookloginbutton","facebookLoginBtn"];""!=u[1]&&null!=u[1]&&"null"!=u[1]&&($("#yournationality").val(u[1]).trigger("blur"),d.push("natErrSuccessTag"));for(var v=0,c=d.length,v=0;v<c;v++)$("#"+d[v]).hide()}else if("DPlogin"==pageloadforfacebook)document.location.reload(!0);else if("Reviewlogin"==pageloadforfacebook)document.location.reload(!0);else if("topnav"==pageloadforfacebook)-1!=o.indexOf("#@#@#@")?null!=(t=o.split("#@#@#@"))[2]&&(weblnk=t[2],-1!=weblnk.indexOf("/registration")||-1!=weblnk.indexOf("/loginhome")?window.location.href="http://"+$1("servernamefacebook").value:window.location.href=weblnk):-1!=o.indexOf("##")&&null!=(t=o.split("##"))[2]&&(weblnk=t[2],-1!=weblnk.indexOf("/registration")||-1!=weblnk.indexOf("/loginhome")?window.location.href="http://"+$1("servernamefacebook").value:window.location.href=weblnk);else if("multipeDPPage"==pageloadforfacebook)g||graphStreamPublish(),null!=u[6]&&"null"!=u[6]?($("#fstname").val(u[4]),$("#lstname").val(u[5]),$("#fstnameId").val(u[4]),$("#lastnameId").val(u[5]),$("#confirmEmailID").val(u[0]),$("#confirmEmailID").attr("readonly",!0),$("#eMail").val(u[0]),$("#eMail").attr("readonly",!0),null!=(s=window.location.href)&&-1!=s.indexOf("&valdn=Y")?(s=s.substring(0,s.indexOf("&valdn=Y")),window.location.href=s):document.location.reload(!0),""!=u[1]&&null!=u[1]&&($1("yournationality").value=u[1])):(null!=$1("multipleDPPage")&&"true"==$1("multipleDPPage").value&&hideShowRegisterDPDiv("newuser"),$("#fstname").trigger("focus").val(u[4]).trigger("blur"),$("#lstname").trigger("focus").val(u[5]).trigger("blur"),$("#fstnameId").trigger("focus").val(u[4]).trigger("blur"),$("#lastnameId").trigger("focus").val(u[5]).trigger("blur"),$("#confirmEmailId").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#confirmEmailID").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur"),$("#checkemailid").val(u[0]),showHideFn("lnameErrorTag","none"),showHideFn("fstNameErrorTag","none"),showHideFn("emailErrMsgTag","none"),showHideFn("confirmEmailSucErrMsg","none"),$("#genderid").val(""),$("#facebookid").val(u[8]),""!=u[1]&&null!=u[1]&&"null"!=u[1]&&($("#yournationality").val(u[1]).trigger("blur"),showHideFn("natErrSuccessTag","none")),showHideFn("enquirydpfacebook","none"),showHideFn("ch_enquirydpfacebook","none"),showHideFn("facebookloginbutton","none"),showHideFn("facebookLoginBtn","none"));else if("externalAgentEnquiry"==pageloadforfacebook){if(g||graphStreamPublish(),null!=u[6]&&"null"!=u[6])$("#fstname").val(u[4]),$("#lstname").val(u[5]),$("#eMail").val(u[0]),$("#eMail").attr("readonly",!0),$("#fstnameId").val(u[4]),$("#lastnameId").val(u[5]),$("#confirmEmailId").val(u[0]),$("#confirmEmailId").attr("readonly",!0),$("#confirmEmailID").val(u[0]),$("#confirmEmailID").attr("readonly",!0),null!=(s=window.location.href)&&-1!=s.indexOf("&valdn=Y")?(s=s.substring(0,s.indexOf("&valdn=Y")),window.location.href=s):null!=$1("eBookLandingURL")&&""!=$1("eBookLandingURL").value?window.location.href=$1("eBookLandingURL").value:document.location.reload(!0),""!=u[1]&&null!=u[1]&&($1("yournationality").value=u[1]);else{"undefined"!=typeof showAndHideAgentLoginform&&showAndHideAgentLoginform("newuser"),$("#fstname").trigger("focus").val(u[4]).trigger("blur").focus(),$("#lstname").trigger("focus").val(u[5]).trigger("blur").focus(),$("#fstnameId").trigger("focus").val(u[4]).trigger("blur").focus(),$("#lastnameId").trigger("focus").val(u[5]).trigger("blur").focus(),$("#confirmEmailId").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur").focus(),$("#confirmEmailID").trigger("focus").val(u[0]).prop("readonly",!0).trigger("blur").focus(),$("#checkemailid").val(u[0]),$("#genderid").val(""),$("#facebookid").val(u[8]);d=["fnamealert","splcharfirstnameerror","serverfnameerror","lnamealert","splcharlastnameerror","serverlnameerror","confirmemailalertalert","useralreadyexist","serveremailiderror","enquirydpfacebook"];""!=u[1]&&null!=u[1]&&"null"!=u[1]&&($("#yournationality").val(u[1]).focus(),d.push("servernationalityalert"),d.push("nationalityalert"));f=0,c=d.length;for(f=0;f<c;f++)$("#"+d[f]).hide()}$("#facebookloginbutton").hide(),$("#facebookLoginBtn").hide(),$("#facebookloginOR").hide()}else"frmLrnMreFB"==pageloadforfacebook&&(g||graphStreamPublish(),openLogInLrnMrePod("frmFB"))}-1!=o.indexOf("#@#@#@")&&null!=(t=o.split("#@#@#@"))[1]&&(weblnk=t[1],window.location.href=weblnk)}function FacebookInviteFriends(){FB.init({appId:$1("apiId").value,cookie:!0,status:!0,xfbml:!0}),FB.ui({method:"apprequests",message:"Refer your friends Page",max:10},function(e){friendslist(e)})}function friendslist(e){e&&e.to&&0<e.to.length&&showfacebookInviteSucess()}function readingListGALog(e,a){var r=e.split("#SP#");1<r.length&&(e=r[0],r=r[1],isBlankOrNull(e)||1==e||"true"==e||("IP Content Hub"==(e=isValidValue("gaPageName")?getIdValue("gaPageName"):getIdValue("dimension1GaName"))?ga("send","event","Register","Save for later",e,1,{dimension1:e,dimension3:$("#gaclgname").val(),dimension19:$("#gaSectionName").val(),nonInteraction:1}):ga("send","event","Register","Save for later",e,1,{nonInteraction:1})),isBlankOrNull(r)||"N"!=r?isBlankOrNull(r)||"Y"!=r||"lightboxregister"==a||(closeLblogin(),r="Your choice is already in your my reading list. Please add a different one.",isValidObject("savedAlrdyY")&&(r=$1("savedAlrdyY").value),alert(r)):trackGaArticleSavelater()),"lightboxregister"==a?isBlankOrNull(getIdValue("refererUrl"))||(window.location.href=getIdValue("refererUrl")):"lightboxlogin"==a&&(isValidObject("dimension1GaName")&&isValidObject("myReadingUrl")&&"Ebook Success"==getIdValue("dimension1GaName")?window.location.href=getIdValue("myReadingUrl"):document.location.reload(!0))}function formFbLoginUrl(e,a){isBlankOrNull(e)||isBlankOrNull(a)||(e=appendQueryOrAmp(e,"page="+encodeURIComponent(a)),a=null,a=!isValidValue("shortListType")||"C"!=$.trim(getIdValue("shortListType"))&&"O"!=$.trim(getIdValue("shortListType"))?window.location.href:getViewComparisonPage($1("shortListType").value,"1","0"),e=appendQueryOrAmp(e,"refererApi="+encodeURIComponent(a))),window.location.href=e}function prepopulateFBDetails(){var e=getSecuredCookie("u_enq");if(null!=e){e=e.split("azw-wza");if(9==e.length){e[2];$("#fstname").trigger("focus").val(e[4]).trigger("blur"),$("#lstname").trigger("focus").val(e[5]).trigger("blur"),$("#fstnameId").trigger("focus").val(e[4]).trigger("blur"),$("#lastnameId").trigger("focus").val(e[5]).trigger("blur"),$("#confirmEmailId").trigger("focus").val(e[0]).prop("readonly",!0).trigger("blur"),$("#confirmEmailID").trigger("focus").val(e[0]).prop("readonly",!0).trigger("blur"),$("#checkemailid").val(e[0]),$("#genderid").val(""),$("#facebookid").val(e[8]);var a=["fstNameErrorTag","lnameErrorTag","emailErrMsgTag","confirmEmailSucErrMsg","enquirydpfacebook","facebookloginbutton","facebookLoginBtn","firstNameErrorTag","lastnameErrorTag"];""!=e[1]&&null!=e[1]&&"null"!=e[1]&&($("#yournationality").val(e[1]).trigger("blur"),a.push("natErrSuccessTag"));for(var r=0,l=a.length,r=0;r<l;r++)$("#"+a[r]).hide()}}}function getViewComparisonPage(e,a,r){var l="",n=findDisplayCount();return"c"!=e.toLowerCase()&&"o"!=e.toLowerCase()||(l="/view-comparison.html?type="+e+"&pageno="+a+"&dispcnt="+n),r&&(l=l+"&expiry="+r),l}